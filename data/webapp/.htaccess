# The X-Frame-Options HTTP response header can be used to indicate whether
# or not a browser should be allowed to render a page in a <frame>, <iframe> or <object> .
<IfModule mod_headers.c>
        Header always set X-Frame-Options SAMEORIGIN
        Header set X-XSS-Protection "1; mode=block"
        Header set X-Content-Type-Options "nosniff"
        Header set Access-Control-Allow-Origin "*"
		Header always set Strict-Transport-Security "max-age=63072000; includeSubDomains; preload"
		Header always edit Set-Cookie (.*) "$1; HTTPOnly; Secure; SameSite=Strict"

        Header set Content-Security-Policy "default-src 'none'; script-src 'self' 'unsafe-inline' 'unsafe-eval' browser-update.org; style-src 'self' 'unsafe-inline'; img-src data:; connect-src 'self'"
        Header set X-Content-Security-Policy "default-src 'none'; script-src 'self' 'unsafe-inline' 'unsafe-eval' browser-update.org; style-src 'self' 'unsafe-inline'; img-src data:; connect-src 'self'"
        Header set X-WebKit-CSP "default-src 'none'; script-src 'self' 'unsafe-inline' 'unsafe-eval' browser-update.org; style-src 'self' 'unsafe-inline'; img-src data:; connect-src 'self'"

</IfModule>

# Disable directory indexing
Options -Indexes

# Deny access to LookingGlass subdirectory
# Overkill, but used for development (dev folder = /LookingGlass)
RedirectMatch 404 /LookingGlass/(.*\.(?:conf|db|sh)|(?:Config|LookingGlass|RateLimit)\.php)$

# Deny access to hidden files/folders
RedirectMatch 404 /\.

# Disable gzip for test files
SetEnvIf Request_URI \.bin$ no-gzip dont-vary